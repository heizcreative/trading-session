<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Live Trading Sessions</title>

<style>
  :root{
    --bg: #191919;
    --text: rgba(255,255,255,.92);
    --muted: rgba(255,255,255,.62);

    --open: #28E6A5;
    --closed: #FF4D6D;

    --radius: 16px;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  }

  *{ box-sizing:border-box; }

  html, body{
    margin:0;
    padding:0;
    height:100%;
    background: var(--bg) !important;
  }

  body{
    color: var(--text);
    font-family: var(--sans);
    padding: 12px;
  }

  .wrap{
    width: min(980px, 100%);
    margin: 0 auto;
  }

  .panel{
    background: var(--bg);
    border: 1px solid rgba(255,255,255,.08);
    border-radius: var(--radius);
    overflow:hidden;
  }

  /* HEADER — CENTERED TIME ONLY */
  .header{
    display:flex;
    justify-content:center;   /* CENTER */
    align-items:center;
    padding: 10px;
    border-bottom: 1px solid rgba(255,255,255,.07);
  }

  .chip{
    font-family: var(--mono);
    font-size: 12px;
    color: rgba(255,255,255,.88);
    padding: 7px 14px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.22);
    white-space:nowrap;
    text-align:center;
    min-width: 92px;
  }

  .grid{
    display:grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 10px;
    padding: 12px;
  }

  @media (max-width: 760px){
    .grid{ grid-template-columns: 1fr; }
  }

  .card{
    border: 1px solid rgba(255,255,255,.10);
    border-radius: 14px;
    padding: 12px;
    background: rgba(255,255,255,.05);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  .top{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
  }

  .left{
    display:flex;
    align-items:center;
    gap:10px;
    min-width:0;
  }

  .dot{
    width:10px;
    height:10px;
    border-radius:50%;
    background: var(--closed);
    box-shadow: 0 0 0 4px rgba(255,77,109,.14);
    flex-shrink:0;
  }

  .names{
    display:flex;
    flex-direction:column;
    gap:2px;
  }

  .names b{
    font-size: 13px;
    white-space:nowrap;
  }

  .names span{
    font-size: 11px;
    color: var(--muted);
  }

  .status{
    font-family: var(--mono);
    font-size: 11px;
    padding: 6px 10px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.18);
    white-space:nowrap;
  }

  .open .dot{
    background: var(--open);
    box-shadow: 0 0 0 4px rgba(40,230,165,.14);
  }

  .open .status{
    color: rgba(40,230,165,.95);
    border-color: rgba(40,230,165,.22);
    background: rgba(40,230,165,.10);
  }

  .closed .status{
    color: rgba(255,77,109,.95);
    border-color: rgba(255,77,109,.22);
    background: rgba(255,77,109,.08);
  }

  .footer{
    padding: 10px 12px 12px;
    border-top: 1px solid rgba(255,255,255,.07);
    color: var(--muted);
    font-size: 11px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    flex-wrap: wrap;
  }

  .pill{
    font-family: var(--mono);
    padding: 3px 10px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.18);
    color: rgba(255,255,255,.75);
    display:inline-flex;
    align-items:center;
    line-height:1;
    white-space:nowrap;
  }

  /* PHONE COMPACT MODE */
  @media (max-width: 430px){
    body{ padding: 6px; }
    .header{ padding: 8px; }
    .chip{ font-size: 11px; padding: 6px 12px; }
    .grid{ padding: 8px; gap: 8px; }
    .card{ padding: 10px; }
    .names b{ font-size: 12px; }
    .names span{ font-size: 10px; }
    .status{ font-size: 10px; padding: 5px 9px; }
    .footer{ padding: 8px; font-size: 10px; }
  }
</style>
</head>

<body>
<div class="wrap">
  <div class="panel">

    <!-- CENTERED TIME -->
    <div class="header">
      <div class="chip" id="etNow">ET --:--</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="footer">
      <div>All times ET (America/Toronto)</div>
      <div class="pill">OPEN / CLOSED only</div>
    </div>

  </div>
</div>

<script>
  const TZ = "America/Toronto";

  const WINDOWS = [
    { key:"asia",   name:"Asia Range",      start:"20:00", end:"00:00" },
    { key:"london", name:"London Killzone", start:"02:00", end:"05:00" },
    { key:"ny",     name:"NY Killzone",     start:"09:30", end:"11:00" }
  ];

  const grid = document.getElementById("grid");

  function getPartsInTZ(tz, date=new Date()){
    const parts = new Intl.DateTimeFormat("en-GB", {
      timeZone: tz,
      hour12:false,
      hour:"2-digit",
      minute:"2-digit"
    }).formatToParts(date);

    const get = (type) => parts.find(p => p.type === type)?.value ?? "00";
    return { hh:get("hour"), mm:get("minute") };
  }

  function minsInTZ(tz){
    const p = getPartsInTZ(tz);
    return Number(p.hh)*60 + Number(p.mm);
  }

  function parseHM(hm){
    const [h,m] = hm.split(":").map(Number);
    return h*60+m;
  }

  function hourLabel(hm){
    const [H] = hm.split(":").map(Number);
    const suffix = H >= 12 ? "PM" : "AM";
    const h12 = ((H + 11) % 12) + 1;
    return `${h12} ${suffix}`;
  }

  function isOpen(win){
    const now = minsInTZ(TZ);
    const s = parseHM(win.start);
    const e = parseHM(win.end);
    return e > s ? (now >= s && now < e) : (now >= s || now < e);
  }

  function build(){
    grid.innerHTML="";
    for(const w of WINDOWS){
      const el=document.createElement("div");
      el.className="card closed";
      el.id=`card-${w.key}`;
      el.innerHTML=`
        <div class="top">
          <div class="left">
            <div class="dot"></div>
            <div class="names">
              <b>${w.name}</b>
              <span>${hourLabel(w.start)}–${hourLabel(w.end)}</span>
            </div>
          </div>
          <div class="status" id="status-${w.key}">CLOSED</div>
        </div>`;
      grid.appendChild(el);
    }
  }

  function updateClock(){
    const p=getPartsInTZ(TZ);
    document.getElementById("etNow").textContent=`ET ${p.hh}:${p.mm}`;
  }

  function updateSessions(){
    for(const w of WINDOWS){
      const open=isOpen(w);
      const card=document.getElementById(`card-${w.key}`);
      const status=document.getElementById(`status-${w.key}`);
      card.classList.toggle("open",open);
      card.classList.toggle("closed",!open);
      status.textContent=open?"OPEN":"CLOSED";
    }
  }

  build();
  updateClock();
  updateSessions();

  setInterval(updateClock,1000);
  setInterval(updateSessions,15000);
</script>
</body>
</html>
